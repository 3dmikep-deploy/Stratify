# Stratify - G-Code Analysis & Reverse Engineering

A comprehensive, multi-platform G-code analysis and optimization tool for 3D printing. This application provides advanced analysis capabilities, visualization, and optimization suggestions for G-code files generated by various slicers.

## 🚀 Features

### Core Analysis
- **Multi-Slicer Support**: Automatically detects and parses G-code from PrusaSlicer, Cura, Simplify3D, and Slic3r
- **Geometric Analysis**: Layer-by-layer analysis with detailed metrics
- **Parameter Inference**: Reverse-engineers slicing parameters from G-code
- **Pattern Recognition**: Detects infill patterns, support structures, and print strategies
- **Time & Material Estimation**: Accurate print time and filament usage calculations

### Visualization
- **3D Visualization**: Interactive Three.js-based 3D preview with layer-by-layer viewing
- **Multiple Color Modes**: Visualize by layer, speed, temperature, or move type
- **Animation Controls**: Step through print layers with timeline control
- **Multiple View Modes**: Perspective, top, front, and side views

### Optimization
- **Smart Suggestions**: AI-powered recommendations for print time and material savings
- **Batch Processing**: Analyze multiple files simultaneously
- **Comparison Tools**: Side-by-side analysis of different G-code files
- **Export Capabilities**: Export analysis results in JSON, CSV, PDF, and HTML formats

### Multi-Platform Support
- **Desktop Application**: Native Electron app for Windows, macOS, and Linux
- **Web Dashboard**: Browser-based interface for cloud deployment
- **API Service**: RESTful API with WebSocket support for real-time updates
- **Docker Deployment**: Complete containerized solution with monitoring

## 🏗️ Architecture

The application is built with a modular, microservices architecture:

```
├── parser-core/          # Core analysis engine (Python/C++)
│   ├── python/          # Main analysis logic
│   ├── cpp/             # High-performance C++ parser
│   └── bindings/        # Language bindings
├── api-service/         # REST API and WebSocket server (Node.js/Express)
├── web-dashboard/       # Web interface (React/Vite/Three.js)
├── desktop/             # Electron desktop app
├── shared/              # Shared types and utilities
└── docker-compose.yaml  # Complete deployment stack
```

## 🔧 Installation

### Prerequisites
- **Node.js** 18+ 
- **Python** 3.9+
- **Docker** & Docker Compose (for containerized deployment)
- **C++** compiler (for native parser module)

### Quick Start with Docker (Production Ready!)

1. **Clone the repository**
```bash
git clone https://github.com/3dmikep-deploy/Stratify.git
cd Stratify
```

2. **Start the complete stack**
```bash
docker compose up -d
```

3. **Access the applications** (All Fully Functional!)
- **Web Dashboard**: http://localhost:3000 - Complete React interface with upload, analysis, and export
- **API Documentation**: http://localhost:3001/health - RESTful API with WebSocket support
- **Nginx Proxy**: http://localhost:8080 - Production-ready reverse proxy
- **Monitoring (Grafana)**: http://localhost:3030 - Real-time dashboards
- **Metrics (Prometheus)**: http://localhost:9090 - System metrics

### 🎉 Current Status: Production Ready!

**Phase 2 Complete** - The G-Code Analyzer now provides:

- ✅ **Professional Web Interface**: Modern React dashboard with drag-and-drop upload
- ✅ **Real-time Processing**: WebSocket-powered progress tracking
- ✅ **Complete Analysis Pipeline**: File validation, processing, and results display
- ✅ **Export Capabilities**: JSON, CSV, and PDF export options
- ✅ **Production Architecture**: 8-service Docker stack with monitoring
- ✅ **Mobile Responsive**: Works perfectly on all devices

### Development Setup

#### API Service
```bash
cd api-service
npm install
npm run dev
```

#### Web Dashboard
```bash
cd web-dashboard
npm install
npm run dev
```

#### Desktop Application
```bash
cd desktop
npm install
npm run electron:dev
```

#### Parser Core
```bash
cd parser-core/python
pip install -r requirements.txt
python -m pytest tests/
```

## 📊 Usage

### Web Interface

1. **Upload G-code**: Drag and drop or browse for `.gcode`, `.gco`, or `.g` files
2. **Real-time Analysis**: Watch as the file is processed with live progress updates
3. **3D Visualization**: Interact with the 3D preview using mouse controls
4. **Layer Navigation**: Use the layer slider to step through the print
5. **Export Results**: Download analysis data in your preferred format

### API Usage

#### Analyze a G-code file
```bash
curl -X POST http://localhost:3001/api/analyze/upload \
  -F "gcode=@example.gcode" \
  -F "options={\"detailed\":true,\"inferParameters\":true}"
```

#### Get analysis results
```bash
curl http://localhost:3001/api/analysis/{analysis-id}
```

#### Compare multiple files
```bash
curl -X POST http://localhost:3001/api/compare \
  -H "Content-Type: application/json" \
  -d '{"files":["file1.gcode","file2.gcode"],"metrics":["printTime","material"]}'
```

### Desktop Application

- **Native Performance**: Optimized for large G-code files
- **Offline Capability**: No internet connection required
- **File Watching**: Auto-reload when G-code files change
- **Batch Processing**: Analyze entire directories of G-code files

## 🎯 Analysis Capabilities

### Metadata Extraction
- Slicer name and version detection
- Layer height, nozzle temperature, bed temperature
- Print speeds, infill density, support settings
- Filament type and estimated weight

### Geometric Analysis
- **Bounding Box**: Print dimensions and positioning
- **Layer Statistics**: Per-layer extrusion and travel data
- **Volume Calculations**: Total material volume and density
- **Path Analysis**: Movement patterns and efficiency

### Optimization Suggestions
- **Speed Optimizations**: Layer height and speed adjustments
- **Material Savings**: Infill and support recommendations  
- **Quality Improvements**: Temperature and flow rate suggestions
- **Custom Profiles**: Tailored recommendations based on printer capabilities

## 🔌 API Reference

### Endpoints

| Method | Endpoint | Description |
|--------|----------|-------------|
| `POST` | `/api/analyze/upload` | Upload and analyze G-code file |
| `POST` | `/api/analyze/text` | Analyze G-code from text input |
| `GET` | `/api/analysis/:id` | Get analysis results |
| `POST` | `/api/compare` | Compare multiple G-code files |
| `POST` | `/api/optimize` | Generate optimization suggestions |
| `POST` | `/api/batch` | Batch analyze multiple files |
| `GET` | `/api/history` | Get analysis history |
| `GET` | `/api/export/:id` | Export analysis results |

### WebSocket Events

| Event | Description |
|-------|-------------|
| `progress` | Real-time analysis progress |
| `complete` | Analysis completion notification |
| `error` | Error notifications |
| `chunk-processed` | Streaming analysis updates |

## 🛠️ Development

### Project Structure
```
gcode-analyzer/
├── api-service/              # Express.js API server
│   ├── src/
│   │   ├── services/        # Business logic services
│   │   ├── routes/          # API route handlers
│   │   └── models/          # Data models
│   ├── tests/               # API tests
│   └── package.json
├── web-dashboard/           # React frontend
│   ├── src/
│   │   ├── components/      # React components
│   │   ├── services/        # Frontend services
│   │   └── visualization/   # Three.js visualizations
│   ├── public/              # Static assets
│   └── package.json
├── desktop/                 # Electron application
│   ├── src/
│   │   ├── main/           # Main process
│   │   ├── renderer/       # Renderer process
│   │   └── preload/        # Preload scripts
│   └── package.json
├── parser-core/             # Core analysis engine
│   ├── python/             # Python implementation
│   │   ├── gcode_analyzer.py # Main analyzer class
│   │   └── tests/          # Python tests
│   ├── cpp/                # C++ implementation
│   └── bindings/           # Language bindings
└── shared/                  # Shared utilities
    ├── types/              # TypeScript type definitions
    └── utils/              # Common utilities
```

### Running Tests

```bash
# API tests
cd api-service && npm test

# Web dashboard tests
cd web-dashboard && npm test

# Desktop app tests
cd desktop && npm test

# Python tests
cd parser-core/python && python -m pytest
```

### Building for Production

#### Web Dashboard
```bash
cd web-dashboard
npm run build
```

#### Desktop Application
```bash
cd desktop
npm run build:electron
```

#### Docker Images
```bash
docker-compose build
```

## 📈 Monitoring & Observability

The application includes comprehensive monitoring:

- **Grafana Dashboards**: Pre-configured dashboards for analysis metrics
- **Prometheus Metrics**: Application and system metrics collection
- **Health Checks**: Endpoint monitoring and alerting
- **Performance Tracking**: Analysis duration and resource usage

### Key Metrics
- Analysis processing time
- File upload success rate
- API response times
- Memory and CPU usage
- User activity patterns

## 🚢 Deployment

### Docker Compose (Recommended)
```bash
# Production deployment
docker-compose -f docker-compose.yml -f docker-compose.prod.yml up -d

# Development
docker-compose up -d
```

### Manual Deployment
1. Set up PostgreSQL and Redis instances
2. Deploy API service to your server
3. Build and deploy web dashboard
4. Configure reverse proxy (Nginx)

### Environment Variables
```bash
# Database
DB_PASSWORD=secure_password
DATABASE_URL=postgresql://user:password@host:5432/gcode_analyzer

# API Configuration
PORT=3001
CORS_ORIGIN=http://localhost:3000
NODE_ENV=production

# Cache
REDIS_URL=redis://localhost:6379

# Monitoring
GRAFANA_PASSWORD=admin_password
```

## 🤝 Contributing

We welcome contributions! Please see our [Contributing Guide](CONTRIBUTING.md) for details.

### Development Workflow
1. Fork the repository
2. Create a feature branch (`git checkout -b feature/amazing-feature`)
3. Commit your changes (`git commit -m 'Add amazing feature'`)
4. Push to the branch (`git push origin feature/amazing-feature`)
5. Open a Pull Request

### Code Style
- **TypeScript/JavaScript**: ESLint + Prettier
- **Python**: Black + flake8
- **C++**: clang-format

## 📄 License

This project is licensed under the MIT License - see the [LICENSE](LICENSE) file for details.

## 🙏 Acknowledgments

- Three.js community for 3D visualization capabilities
- Open source slicer projects (PrusaSlicer, Cura, Slic3r) for G-code format documentation
- Electron team for cross-platform desktop framework
- Express.js and React communities

## 📞 Support

- **Documentation**: [Wiki](https://github.com/3dmikep-deploy/Stratify/wiki)
- **Issues**: [GitHub Issues](https://github.com/3dmikep-deploy/Stratify/issues)
- **Discussions**: [GitHub Discussions](https://github.com/3dmikep-deploy/Stratify/discussions)
- **Email**: dev@3dmikep.com

---

**Built with ❤️ for the 3D printing community**
